name: QA

on:
  push:
    branches:
      - main
  pull_request:
     branches:
      - main
  workflow_dispatch:

concurrency:
  group: ${{ github.workflow }}-${{ github.event.pull_request.number || github.ref }}
  cancel-in-progress: true

env:
  APP_URL: http://localhost:81/ui/#/
  CXBOX_LOGGER:  true

jobs:
  build-2:
    runs-on: ubuntu-latest
    env:
      APP_URL: http://code-samples.cxbox.org/ui/#/
    steps:
    - name: Check disk space
      run: df -h
    - name: Check runner directories size
      run: du -h --max-depth=1 /home/runner/actions-runner | sort -h
    - name: Check diag blocks
      run: du -h --max-depth=1 /home/runner/actions-runner/cached/_diag/blocks | sort -h
    - name: Find largest cached diag files
      run: |
        find /home/runner/actions-runner/cached/_diag/blocks -type f -printf "%s %p\n" \
          | sort -nr | head -n 20


